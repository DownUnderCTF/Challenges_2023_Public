1. What happens when you add your own X-Forwarded-For header?
2. Look carefully at the control flow that handles the X-Forwarded-For header
